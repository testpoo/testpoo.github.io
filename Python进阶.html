<!doctype html>
  <html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>测试铺</title>
    <link rel="stylesheet" type="text/css" href="https://testpoo.github.io/themes/css/style.css">
    <link rel="stylesheet" type="text/css" href="https://testpoo.github.io/themes/css/xui.css">
    <link rel="stylesheet" type="text/css" href="https://testpoo.github.io/themes/css/markdown.css">
    <link rel="shortcut icon" type="image/ico" href="https://testpoo.github.io/themes/img/favicon.ico">
  </head>

  <body>
    <div class="sider">
      <div class="categories">
        <div class="title">
          <a href="https://testpoo.github.io">
            <img src="https://testpoo.github.io/themes/img/title.jpg">
            <div class="linkbutton testpoo">测试铺</div>
          </a>
        </div>
        <div class="scrollheight">
          <ul>
            
            <li><a href="https://testpoo.github.io/debian+openbox+tint2安装过程.html"><label style="color: #ffba48"></label>&nbsp;debian</a></li>
            
            <li><a href="https://testpoo.github.io/面试问答.html"><label style="color: #ffba48"></label>&nbsp;笔记</a></li>
            
            <li><a href="https://testpoo.github.io/常用链接.html"><label style="color: #ffba48"></label>&nbsp;常用链接</a></li>
            
            <li><a href="https://testpoo.github.io/mysql函数汇总.html"><label style="color: #ffba48"></label>&nbsp;mysql</a></li>
            
            <li><a href="https://testpoo.github.io/shell简介.html"><label style="color: #ffba48"></label>&nbsp;linux</a></li>
            
            <li><a href="https://testpoo.github.io/Python进阶.html"><label style="color: #ffba48"></label>&nbsp;python</a></li>
            
            <li><a href="https://testpoo.github.io/问题解决.html"><label style="color: #ffba48"></label>&nbsp;问题解决</a></li>
            
          </ul>
        </div>
        <div class="github"><a href="https://github.com/testpoo" target="_blank" title="GitHub:TestPoo"></a><a href="#" title="微信号：puyaweis"></a><a href="#" title="邮箱：pu_yawei@qq.com"></a><a href="https://testpoo.github.io/rss.xml" target="_blank"></a></div>
      </div>
      <div class="articles">
        <div class="category">分类：python</div>
        <div class="scrollheight">
          <ul>
            
            <li><a href="https://testpoo.github.io/Python进阶.html"><span><label style="color: #38b6fd"></label>&nbsp;Python进阶</span><span>2021-11-30&nbsp;&nbsp;共121649个字</span></a></li>
            
            <li><a href="https://testpoo.github.io/Python正则表达式.html"><span><label style="color: #38b6fd"></label>&nbsp;Python正则表达式</span><span>2021-06-23&nbsp;&nbsp;共45046个字</span></a></li>
            
            <li><a href="https://testpoo.github.io/nose简介.html"><span><label style="color: #38b6fd"></label>&nbsp;nose简介</span><span>2021-06-04&nbsp;&nbsp;共206400个字</span></a></li>
            
            <li><a href="https://testpoo.github.io/Python自动化之unittest.html"><span><label style="color: #38b6fd"></label>&nbsp;Python自动化之unittest</span><span>2021-04-21&nbsp;&nbsp;共92782个字</span></a></li>
            
            <li><a href="https://testpoo.github.io/分分种学会python3.html"><span><label style="color: #38b6fd"></label>&nbsp;分分种学会python3</span><span>2020-05-14&nbsp;&nbsp;共33494个字</span></a></li>
            
            <li><a href="https://testpoo.github.io/python标准异常.html"><span><label style="color: #38b6fd"></label>&nbsp;python标准异常</span><span>2019-10-11&nbsp;&nbsp;共2684个字</span></a></li>
            
          </ul>
        </div>
        <div class="item-num">总共6项</div>
      </div>
    </div>
    <div class="main">
      <div class="header"><span>Python进阶</span><span>一个80后老人，专注测试领域<br />最后更新于2022-07-20 17:51:35</span></div>
      <input class="xswitch xonoff" type="checkbox" id="catalog">
      <div class="posts"><div class="toc">
<ul>
<li><a href="#argskwargs">*args和**kwargs</a><ul>
<li><a href="#args">*args</a></li>
<li><a href="#kwargs">**kwargs的用法</a></li>
<li><a href="#argskwargs_1">使用*args和**kwargs来调用函数</a></li>
</ul>
</li>
<li><a href="#debugging">调试Debugging</a><ul>
<li><a href="#_1">从命令运行</a></li>
<li><a href="#_2">从脚本内部运行</a></li>
</ul>
</li>
<li><a href="#generators">生成器Generators</a><ul>
<li><a href="#iterable">可迭代对象（Iterable）</a></li>
<li><a href="#iterator">迭代器（Iterator）</a></li>
<li><a href="#iteration">迭代（Iteration）</a></li>
<li><a href="#generators_1">生成器（Generators）</a></li>
</ul>
</li>
<li><a href="#mapfilterreduce">Map，Filter和Reduce</a><ul>
<li><a href="#map">Map</a></li>
<li><a href="#filter">Filter</a></li>
<li><a href="#reduce">Reduce</a></li>
</ul>
</li>
<li><a href="#set">set（集合）数据结构</a><ul>
<li><a href="#set_1">set</a></li>
<li><a href="#_3">交集</a></li>
<li><a href="#_4">差集</a></li>
</ul>
</li>
<li><a href="#_5">三元运算符</a></li>
<li><a href="#_6">装饰器</a><ul>
<li><a href="#_7">第一个装饰器</a></li>
<li><a href="#_8">使用场景</a></li>
<li><a href="#_9">带参数的装饰器</a></li>
</ul>
</li>
<li><a href="#globalreturn">Global和Return</a><ul>
<li><a href="#return">多个return值</a></li>
</ul>
</li>
<li><a href="#mutation">对象变动（Mutation)</a></li>
<li><a href="#__slots__">__slots__魔法</a></li>
<li><a href="#_10">虚拟环境</a><ul>
<li><a href="#virtualenv">virtualenv</a></li>
</ul>
</li>
<li><a href="#collections">容器Collections</a><ul>
<li><a href="#defaultdict">defaultdict</a></li>
<li><a href="#counter">Counter</a></li>
<li><a href="#deque">deque</a></li>
<li><a href="#namedtuple">namedtuple</a></li>
<li><a href="#enumenum">enum.Enum</a></li>
</ul>
</li>
<li><a href="#enumerate">枚举Enumerate</a></li>
<li><a href="#_11">对象自省</a><ul>
<li><a href="#dir">dir</a></li>
<li><a href="#typeid">type和id</a></li>
<li><a href="#inspect">inspect模块</a></li>
</ul>
</li>
<li><a href="#comprehension">推导式Comprehension</a><ul>
<li><a href="#_12">列表推导式</a></li>
<li><a href="#_13">字典推导式</a></li>
<li><a href="#_14">集合推导式</a></li>
</ul>
</li>
<li><a href="#_15">异常</a><ul>
<li><a href="#_16">处理多个异常</a></li>
<li><a href="#finally">finally从句</a></li>
<li><a href="#tryelse">try/else从句</a></li>
</ul>
</li>
<li><a href="#lambda">lambda表达式</a></li>
</ul>
</div>
<h3 id="argskwargs"><code>*args</code>和<code>**kwargs</code></h3>
<p>大部分人学习Python，很多时间都搞不清楚<code>*args</code>和<code>**kwargs</code>这两个变量。其实这两个变量并不是必须写<code>*args</code>和<code>**kwargs</code>。只要变量前面的<code>*</code>才是必须的。你也可以写成<code>*var</code>和<code>**vars</code>。写成<code>*args</code>和<code>**kwargs</code>只是一个通俗的命名约定。</p>
<h4 id="args"><code>*args</code></h4>
<p><code>*args</code>和<code>**kwargs</code>主要用于函数定义。你可以将不定数量的参数传递给一个函数。这里的不定的意思是：预先并不知道，函数使用者会传递多少个参数给你，所以在这个场景下使用这两个关键字。<code>*args</code>是用来发送一个非键值对的可变数量的参数列表给一个函数。例如：</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span> <span class="n">test_var_args</span><span class="p">(</span><span class="n">f_arg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;第一个普通的参数：&quot;</span><span class="p">,</span> <span class="n">f_arg</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;另外一些通过*argv传递的参数:&quot;</span><span class="p">,</span> <span class="n">arg</span><span class="p">)</span>

<span class="n">test_var_args</span><span class="p">(</span><span class="s1">&#39;苹果&#39;</span><span class="p">,</span><span class="s1">&#39;香蕉&#39;</span><span class="p">,</span><span class="s1">&#39;梨子&#39;</span><span class="p">,</span><span class="s1">&#39;葡萄&#39;</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>第一个普通的参数： 苹果
另外一些通过*argv传递的参数: 香蕉
另外一些通过*argv传递的参数: 梨子
另外一些通过*argv传递的参数: 葡萄
</code></pre></div>

<h4 id="kwargs"><code>**kwargs</code>的用法</h4>
<p><code>**kwargs</code>允许你将不定长度的键值对，作为参数传递给一个函数。如果你想要在一个函数里处理带名字的参数，你应该使用<code>**kwargs</code>。例如：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">greet_me</span><span class="ss">(</span><span class="o">**</span><span class="nv">kwargs</span><span class="ss">)</span>:
    <span class="k">for</span> <span class="nv">key</span>, <span class="nv">value</span> <span class="nv">in</span> <span class="nv">kwargs</span>.<span class="nv">items</span><span class="ss">()</span>:
        <span class="nv">print</span><span class="ss">(</span><span class="s2">&quot;</span><span class="s">{0} == {1}</span><span class="s2">&quot;</span>.<span class="nv">format</span><span class="ss">(</span><span class="nv">key</span>, <span class="nv">value</span><span class="ss">))</span>

<span class="nv">greet_me</span><span class="ss">(</span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">苹果</span><span class="s2">&quot;</span><span class="ss">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>name == 苹果
</code></pre></div>

<p>现在可以看出怎样在一个函数里，处理一个键值对参数了。</p>
<h4 id="argskwargs_1">使用<code>*args</code>和<code>**kwargs</code>来调用函数</h4>
<p>现在我们来看看怎样使用<code>*args</code>和<code>**kwargs</code>来调用一个函数。假设，有这样一个函数：</p>
<div class="codehilite"><pre><span></span><code>def test_args_kwargs(arg1, arg2, arg3): 
    print(&quot;arg1:&quot;, arg1) 
    print(&quot;arg2:&quot;, arg2) 
    print(&quot;arg3:&quot;, arg3)
</code></pre></div>

<p>你可以使用<code>*args</code>和<code>**kwargs</code>来给这个函数传递参数，如下：</p>
<div class="codehilite"><pre><span></span><code># 首先使用*args
args = (&quot;二&quot;, 3, 5)
test_args_kwargs(*args)
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="n">arg1</span><span class="o">:</span> <span class="err">二</span>
<span class="n">arg2</span><span class="o">:</span> <span class="mi">3</span>
<span class="n">arg3</span><span class="o">:</span> <span class="mi">5</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code># 现在使⽤ **kwargs: 
kwargs = {&quot;arg3&quot;: 3, &quot;arg2&quot;: &quot;二&quot;, &quot;arg1&quot;: 5} 
test_args_kwargs(**kwargs) 
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="n">arg1</span><span class="o">:</span> <span class="mi">5</span> 
<span class="n">arg2</span><span class="o">:</span> <span class="err">二</span> 
<span class="n">arg3</span><span class="o">:</span> <span class="mi">3</span> 
</code></pre></div>

<p><strong>标准参数与<code>*args</code>和<code>**kwargs</code>在使用时的顺序</strong></p>
<p>那么如果你想在函数⾥同时使⽤所有这三种参数， 顺序是这样的： </p>
<div class="codehilite"><pre><span></span><code>some_func(fargs, *args, **kwargs)
</code></pre></div>

<h3 id="debugging">调试Debugging</h3>
<p>利用好调试，能大提高我们捕捉代码的bug。大部分人忽略了Python debugger（pdb）的重要性。在这里会讲一些重要的命令，其他的可以从官方文档中学习。地址如下：</p>
<p>https://docs.python.org/3/library/pdb.html </p>
<h4 id="_1">从命令运行</h4>
<p>你可以在命令行使用Python debugger运行一个脚本，举个例子：</p>
<div class="codehilite"><pre><span></span><code>python -m pdb my_script.py
</code></pre></div>

<p>这会触发debugger在脚本第一行指令处停止执行。这个对比较短的脚本很有帮助。</p>
<h4 id="_2">从脚本内部运行</h4>
<p>可以在脚本内设置数点，这样就可以在某些特定点查看变量信息和各种执行时信息了。使用<code>pdb.set_trace()</code>方法来实现。举例说明：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">pdb</span> 
<span class="k">def</span> <span class="nf">make_bread</span><span class="p">():</span> 
    <span class="n">pdb</span><span class="o">.</span><span class="n">set_trace</span><span class="p">()</span> 
    <span class="k">return</span> <span class="s2">&quot;I don&#39;t have time&quot;</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">make_bread</span><span class="p">())</span>
</code></pre></div>

<p>运行上面的脚本，会立刻进入debugger模式。其操作命令如下：</p>
<ul>
<li>
<p>c：继续执行</p>
</li>
<li>
<p>w：显示当前正在执行的代码行的上下文信息</p>
</li>
<li>
<p>a：打印当前函数的参数列表</p>
</li>
<li>
<p>s：执行当前代码行，并停在第一个能停的地方（相当于单步进入）</p>
</li>
<li>
<p>n：继续执行到当前函数的下一行，或者当前行直接返回（单步跳过）</p>
</li>
</ul>
<p>单步路过和单步进入的区别在于，单步进入会进入当前行调用的函数内部停在里面，而单步跳过会全速执行完成当前调用的函数，并停在当前函数的下一行。</p>
<h3 id="generators">生成器Generators</h3>
<p>讲解生成器之前，我们先说一下迭代器。迭代器是一个让程序可以遍历一个容器（特别是列表）的对象。然而，一个迭代器在遍历并读取一个容器的数据元素时，并不会执行一个迭代。它有三个部分：</p>
<ul>
<li>可迭代对象（Iterable）</li>
<li>迭代器（Iterator）</li>
<li>迭代（Iteration）</li>
</ul>
<p>上面这些部分互相联系。我们先来讨论他们，然后再讨论生成器（generators）。</p>
<h4 id="iterable">可迭代对象（Iterable）</h4>
<p>Python中任意的对象，只要它定义了可以返回一个迭代器<code>__iter__</code>方法，或者定义了可以支持下标索引的<code>__getitem__</code>方法，那么安就是一个可迭代器。简单说，可迭代对象就是能提供迭代器的任意对象。</p>
<h4 id="iterator">迭代器（Iterator）</h4>
<p>任意对象，只要定义了<code>__next__</code>方法，它就是一个迭代器。</p>
<h4 id="iteration">迭代（Iteration）</h4>
<p>迭代就是从某个地方（比如一个列表）取出一个元素的过程。当我们使用一个循环来遍历某个东西时，这个过程本身就叫迭代。</p>
<h4 id="generators_1">生成器（Generators）</h4>
<p>生成器也是一种迭代器，但是你只能对其迭代一次。这是因为他们并没有把所有的值存在内存中，而是在运行时生成值。你通过遍历来用不用它们，要么用一个”for“循环，要么将它们传递给任意可以进行迭代的函数和结构。大多数时个生成器是以函数来实现的。然而，他们并不返回一个值，而是yield一个值。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">generator_function</span><span class="ss">()</span>:
    <span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="mi">10</span><span class="ss">)</span>:
        <span class="nv">yield</span> <span class="nv">i</span>

<span class="k">for</span> <span class="nv">item</span> <span class="nv">in</span> <span class="nv">generator_function</span><span class="ss">()</span>:
    <span class="nv">print</span><span class="ss">(</span><span class="nv">item</span><span class="ss">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">0</span>
<span class="mf">1</span>
<span class="mf">2</span>
<span class="mf">3</span>
<span class="mf">4</span>
<span class="mf">5</span>
<span class="mf">6</span>
<span class="mf">7</span>
<span class="mf">8</span>
<span class="mf">9</span>
</code></pre></div>

<p>这个例子并不是非常实用。生成器最佳应用场景是：你不想同一时间将所有计算出来的大量结果集分配到内存当中，特别是结果集里还包含循环。这样做会消耗大量的资源。</p>
<p>下面是一个计算斐波那契数列的生成器：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">fibon</span><span class="ss">(</span><span class="nv">n</span><span class="ss">)</span>:
    <span class="nv">a</span> <span class="o">=</span> <span class="nv">b</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="nv">n</span><span class="ss">)</span>:
        <span class="nv">yield</span> <span class="nv">a</span>
        <span class="nv">a</span>, <span class="nv">b</span> <span class="o">=</span> <span class="nv">b</span>, <span class="nv">a</span> <span class="o">+</span> <span class="nv">b</span>

<span class="k">for</span> <span class="nv">x</span> <span class="nv">in</span> <span class="nv">fibon</span><span class="ss">(</span><span class="mi">1000000</span><span class="ss">)</span>:
    <span class="nv">print</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>
</code></pre></div>

<p>用这种方式，我们可以不用担心它会使用大量资源。然而，之前如果我们这样实现的话：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">fibon</span><span class="ss">(</span><span class="nv">n</span><span class="ss">)</span>:
    <span class="nv">a</span> <span class="o">=</span> <span class="nv">b</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="nb">result</span> <span class="o">=</span> []
    <span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="nv">n</span><span class="ss">)</span>:
        <span class="nb">result</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">a</span><span class="ss">)</span>
        <span class="nv">a</span>, <span class="nv">b</span> <span class="o">=</span> <span class="nv">b</span>, <span class="nv">a</span> <span class="o">+</span> <span class="nv">b</span>
    <span class="k">return</span> <span class="nb">result</span>
</code></pre></div>

<p>这个会在计算很大的输入参数时，占用大量的资源。我们现在来测试一下生成器使用一次迭代，我们使用python的内置函数：<code>next()</code>，它可以获取一个序列的下一个元素。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">generator_function</span><span class="ss">()</span>:
    <span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="mi">3</span><span class="ss">)</span>:
        <span class="nv">yield</span> <span class="nv">i</span>

<span class="nv">gen</span> <span class="o">=</span> <span class="nv">generator_function</span><span class="ss">()</span>

<span class="nv">print</span><span class="ss">(</span><span class="k">next</span><span class="ss">(</span><span class="nv">gen</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="k">next</span><span class="ss">(</span><span class="nv">gen</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="k">next</span><span class="ss">(</span><span class="nv">gen</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="k">next</span><span class="ss">(</span><span class="nv">gen</span><span class="ss">))</span>
</code></pre></div>

<p>执行结果:</p>
<div class="codehilite"><pre><span></span><code><span class="mf">0</span>
<span class="mf">1</span>
<span class="mf">2</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s">&quot;E:\公司文档\分享内容\markdown\python进阶\8.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mf">12</span><span class="p">,</span> <span class="n">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="kr">print</span><span class="p">(</span><span class="kr">next</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>
<span class="kr">Stop</span><span class="n">Iteration</span>
</code></pre></div>

<p>从结果中可以看出，在yield掉所有值后，next()触发了一个StopIteration的异常。这个说明所有的值都已经yield完了。for循环会自动捕捉这个异常并停止调用next()，所以for循环没有这个异常。</p>
<p>Python中有些内置数据也支持迭代，如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">my_string</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">tester</span><span class="s2">&quot;</span> 
<span class="nv">my_iter</span> <span class="o">=</span> <span class="nv">iter</span><span class="ss">(</span><span class="nv">my_string</span><span class="ss">)</span> 
<span class="nv">print</span><span class="ss">(</span><span class="k">next</span><span class="ss">(</span><span class="nv">my_iter</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="k">next</span><span class="ss">(</span><span class="nv">my_iter</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="k">next</span><span class="ss">(</span><span class="nv">my_iter</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="k">next</span><span class="ss">(</span><span class="nv">my_iter</span><span class="ss">))</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>t
e
s
t
</code></pre></div>

<h3 id="mapfilterreduce">Map，Filter和Reduce</h3>
<h4 id="map">Map</h4>
<p>Map会将一个函数映射到一个输入列表的所有元素上。如下：</p>
<div class="codehilite"><pre><span></span><code>map(function_to_apply, list_of_inputs)
</code></pre></div>

<p>一般而言，要把列表中所有元素一个个地传递给一个函数，并收集输出。应做如下操作：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">items</span> <span class="o">=</span> [<span class="mi">1</span>, <span class="mi">2</span>, <span class="mi">3</span>, <span class="mi">4</span>, <span class="mi">5</span>]
<span class="nv">squared</span> <span class="o">=</span> []
<span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">items</span>:
    <span class="nv">squared</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">i</span><span class="o">**</span><span class="mi">2</span><span class="ss">)</span>
</code></pre></div>

<p>Map可以用一种简单得多的方式来实现。如下：</p>
<div class="codehilite"><pre><span></span><code>items = [1, 2, 3, 4, 5]
squared = list(map(lambda x:x**2, items))
</code></pre></div>

<p>大多数时候，我们使用匿名函数（lambda）来配合map。其不仅可用于列表的输入，甚至可以用于列表的函数。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">multiply</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>:
    <span class="k">return</span> <span class="ss">(</span><span class="nv">x</span><span class="o">*</span><span class="nv">x</span><span class="ss">)</span>

<span class="nv">def</span> <span class="nv">add</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span>:
    <span class="k">return</span> <span class="ss">(</span><span class="nv">x</span><span class="o">+</span><span class="nv">x</span><span class="ss">)</span>

<span class="nv">funcs</span> <span class="o">=</span> [<span class="nv">multiply</span>, <span class="nv">add</span>]
<span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="mi">5</span><span class="ss">)</span>:
    <span class="nv">value</span> <span class="o">=</span> <span class="nv">list</span><span class="ss">(</span><span class="nv">map</span><span class="ss">(</span><span class="nv">lambda</span> <span class="nv">x</span>:<span class="nv">x</span><span class="ss">(</span><span class="nv">i</span><span class="ss">)</span>, <span class="nv">funcs</span><span class="ss">))</span>
    <span class="nv">print</span><span class="ss">(</span><span class="nv">value</span><span class="ss">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="k">[0, 0]</span>
<span class="k">[1, 2]</span>
<span class="k">[4, 4]</span>
<span class="k">[9, 6]</span>
<span class="k">[16, 8]</span>
</code></pre></div>

<h4 id="filter">Filter</h4>
<p>filter过滤列表中的元素，并返回一个由所有符合要求的元素所构成的列表。如下:</p>
<div class="codehilite"><pre><span></span><code>number_list = range(-5, 5)
less_than_zero = list(filter(lambda x:x&lt;0, number_list))
print(less_than_zero)
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>[-5, -4, -3, -2, -1]
</code></pre></div>

<p>filter类似for循环，但它是一个内置函数，并且更快。</p>
<h4 id="reduce">Reduce</h4>
<p>当需要对一个列表进行一些计算并返回结果时，Reduce是个非常有用的函数。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>
<span class="n">product</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">((</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="n">x</span> <span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">24</span>
</code></pre></div>

<h3 id="set">set（集合）数据结构</h3>
<h4 id="set_1">set</h4>
<p>set（集合）是一个非常有用的数据结构。它与列表（list）的行为类似，区别在于set不能包含重复的值。这在去重和检查列表中是否包含重复元素很有用。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">some_list</span> <span class="o">=</span> [<span class="s1">&#39;</span><span class="s">a</span><span class="s1">&#39;</span>,<span class="s1">&#39;</span><span class="s">b</span><span class="s1">&#39;</span>,<span class="s1">&#39;</span><span class="s">c</span><span class="s1">&#39;</span>,<span class="s1">&#39;</span><span class="s">b</span><span class="s1">&#39;</span>,<span class="s1">&#39;</span><span class="s">d</span><span class="s1">&#39;</span>,<span class="s1">&#39;</span><span class="s">m</span><span class="s1">&#39;</span>,<span class="s1">&#39;</span><span class="s">n</span><span class="s1">&#39;</span>,<span class="s1">&#39;</span><span class="s">n</span><span class="s1">&#39;</span>]
<span class="nv">duplicates</span> <span class="o">=</span> <span class="nv">set</span><span class="ss">(</span>[<span class="nv">x</span> <span class="k">for</span> <span class="nv">x</span> <span class="nv">in</span> <span class="nv">some_list</span> <span class="k">if</span> <span class="nv">some_list</span>.<span class="nv">count</span><span class="ss">(</span><span class="nv">x</span><span class="ss">)</span> <span class="o">&gt;</span> <span class="mi">1</span>]<span class="ss">)</span>

<span class="nv">print</span><span class="ss">(</span><span class="nv">duplicates</span><span class="ss">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>{&#39;n&#39;, &#39;b&#39;}
</code></pre></div>

<h4 id="_3">交集</h4>
<p>对比两个集合的交集，如下：</p>
<div class="codehilite"><pre><span></span><code>valid = set([&#39;yellow&#39;,&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;,&#39;black&#39;])
input_set = set([&#39;red&#39;,&#39;brown&#39;])
print(input_set.intersection(valid))
</code></pre></div>

<p>执行结果:</p>
<div class="codehilite"><pre><span></span><code>{&#39;red&#39;}
</code></pre></div>

<p>注：intersection() 方法用于返回两个或更多集合中都包含的元素，即交集。</p>
<h4 id="_4">差集</h4>
<p>用差集找出无效的数据，如下：</p>
<div class="codehilite"><pre><span></span><code>valid = set([&#39;yellow&#39;,&#39;red&#39;,&#39;blue&#39;,&#39;green&#39;,&#39;black&#39;])
input_set = set([&#39;red&#39;,&#39;brown&#39;])
print(input_set.difference(valid))
</code></pre></div>

<p>执行结果:</p>
<div class="codehilite"><pre><span></span><code>{&#39;brown&#39;}
</code></pre></div>

<p>注：difference() 方法用于返回集合的差集，即返回的集合元素包含在第一个集合中，但不包含在第二个集合(方法的参数)中。</p>
<h3 id="_5">三元运算符</h3>
<p>三元运算符通常被称为条件表达式，这些表达式基于真(true)/假(not)的条件判断。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">condition_is_true</span> <span class="k">if</span> <span class="nv">condiiton</span> <span class="k">else</span> <span class="nv">condition_is_false</span>
</code></pre></div>

<p>举个例子：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">is_fat</span> <span class="o">=</span> <span class="nv">True</span>
<span class="nv">state</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">fat</span><span class="s2">&quot;</span> <span class="k">if</span> <span class="nv">is_fat</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="s">not fat</span><span class="s2">&quot;</span>
</code></pre></div>

<p>它还有一种不常用的用法，使用了元组，如下：</p>
<div class="codehilite"><pre><span></span><code><span class="p">(</span><span class="n">if_test_if_false</span><span class="p">,</span><span class="w"> </span><span class="n">if_test_is_true</span><span class="p">)</span><span class="o">[</span><span class="n">test</span><span class="o">]</span><span class="w"></span>
</code></pre></div>

<p>举个例子：</p>
<div class="codehilite"><pre><span></span><code><span class="n">fat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>
<span class="n">fitness</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;skinny&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;fat&quot;</span><span class="p">)</span><span class="o">[</span><span class="n">fat</span><span class="o">]</span><span class="w"></span>
<span class="k">print</span><span class="p">(</span><span class="ss">&quot;All is&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fitness</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>All is fat
</code></pre></div>

<p>一般不建议使用元组条件表达式的缘故是在元组中会把两个条件都执行，而if else的条件表达式不会。例如：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">condition</span> <span class="o">=</span> <span class="nv">True</span>
<span class="nv">print</span><span class="ss">(</span><span class="mi">2</span> <span class="k">if</span> <span class="nv">condition</span> <span class="k">else</span> <span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="ss">)</span>
</code></pre></div>

<p>执行如果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">2</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code><span class="k">condition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">True</span><span class="w"></span>
<span class="k">print</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">0</span><span class="p">)</span><span class="o">[</span><span class="n">condition</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="n">ZeroDivisionError</span><span class="o">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</code></pre></div>

<h3 id="_6">装饰器</h3>
<p>装饰器是修改其他函数的功能的函数。</p>
<h4 id="_7">第一个装饰器</h4>
<p>如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">a_new_decorator</span><span class="ss">(</span><span class="nv">a_func</span><span class="ss">)</span>:

    <span class="nv">def</span> <span class="nv">wrapTheFunction</span><span class="ss">()</span>:
        <span class="nv">print</span><span class="ss">(</span><span class="s2">&quot;</span><span class="s">在执行a_func函数之前我正在干一些无趣的事情</span><span class="s2">&quot;</span><span class="ss">)</span>
        <span class="nv">a_func</span><span class="ss">()</span>
        <span class="nv">print</span><span class="ss">(</span><span class="s2">&quot;</span><span class="s">在执行a_func函数之后我正在干一些无趣的事情</span><span class="s2">&quot;</span><span class="ss">)</span>

    <span class="k">return</span> <span class="nv">wrapTheFunction</span>

<span class="nv">def</span> <span class="nv">a_function_requiring_decoration</span><span class="ss">()</span>:
    <span class="nv">print</span><span class="ss">(</span><span class="s2">&quot;</span><span class="s">我需要一些装饰来掩饰我的伤口</span><span class="s2">&quot;</span><span class="ss">)</span>
</code></pre></div>

<p>执行1及结果：</p>
<div class="codehilite"><pre><span></span><code>a_function_requiring_decoration()
# 执行结果：
我需要一些装饰来掩饰我的伤口
</code></pre></div>

<p>执行2及结果：</p>
<div class="codehilite"><pre><span></span><code>a_function_requiring_decoration = a_new_decorator(a_function_requiring_decoration)

a_function_requiring_decoration()
# 执行结果：
在执行a_func函数之前我正在干一些无趣的事情
我需要一些装饰来掩饰我的伤口
在执行a_func函数之后我正在干一些无趣的事情
</code></pre></div>

<p>以上就是python中装饰器的作用。它封装一个函数，并且用一些方式来修改它的行为。下面我们使用@来运行之前的代码：</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">a_new_decorator</span><span class="p">(</span><span class="n">a_func</span><span class="p">)</span><span class="err">:</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">wrapTheFunction</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;在执行a_func函数之前我正在干一些无趣的事情&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="n">a_func</span><span class="p">()</span><span class="w"></span>
<span class="w">        </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;在执行a_func函数之后我正在干一些无趣的事情&quot;</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">wrapTheFunction</span><span class="w"></span>

<span class="nv">@a_new_decorator</span><span class="w"></span>
<span class="n">def</span><span class="w"> </span><span class="n">a_function_requiring_decoration</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="n">装饰</span><span class="w"></span>
<span class="w">    </span><span class="k">print</span><span class="p">(</span><span class="ss">&quot;我需要一些装饰来掩饰我的伤口&quot;</span><span class="p">)</span><span class="w"></span>

<span class="n">a_function_requiring_decoration</span><span class="p">()</span><span class="w"></span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>在执行a_func函数之前我正在干一些无趣的事情
我需要一些装饰来掩饰我的伤口
在执行a_func函数之后我正在干一些无趣的事情
</code></pre></div>

<p>附：<code>@a_new_decorator</code>是<code>a_function_requiring_decoration = a_new_decorator(a_function_requiring_decoration)</code>的缩略方式</p>
<p>现在我们对装饰器有了一个基本的了解。如果我们运行下面的代码会有一个问题：</p>
<div class="codehilite"><pre><span></span><code>print(a_function_requiring_decoration.__name__)
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>wrapTheFunction
</code></pre></div>

<p>这个并不是我们想要的，Python提供了一个函数来解决这个问题，那就是functools.wraps。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">a_new_decorator</span><span class="p">(</span><span class="n">a_func</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">a_func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapTheFunction</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;在执行a_func函数之前我正在干一些无趣的事情&quot;</span><span class="p">)</span>
        <span class="n">a_func</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;在执行a_func函数之后我正在干一些无趣的事情&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapTheFunction</span>

<span class="nd">@a_new_decorator</span>
<span class="k">def</span> <span class="nf">a_function_requiring_decoration</span><span class="p">():</span>
    <span class="c1"># 装饰</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;我需要一些装饰来掩饰我的伤口&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a_function_requiring_decoration</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>a_function_requiring_decoration
</code></pre></div>

<p><strong>装饰器规范</strong></p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="k">def</span> <span class="nf">decorator_name</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">decorated</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">can_run</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Function will not run&quot;</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decorated</span>
<span class="nd">@decorator_name</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="k">return</span><span class="p">(</span><span class="s2">&quot;Function is running&quot;</span><span class="p">)</span>
</code></pre></div>

<p>执行1及结果：</p>
<div class="codehilite"><pre><span></span><code>can_run = True
print(func())
# 执行结果
Function is running
</code></pre></div>

<p>执行2及结果：</p>
<div class="codehilite"><pre><span></span><code>can_run = False
print(func())
# 执行结果
Function is not running
</code></pre></div>

<p>注：@wraps接受一个函数来进行装饰，并加入复制函数名称、注释文档、参数列表等功能。</p>
<h4 id="_8">使用场景</h4>
<p><strong>授权(Authorization)</strong></p>
<p>装饰器有助于检查是否被授权去使用一个web应用的端点。它被大量用于Flask和Django框架中。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">requires_auth</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">decorated</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">auth</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">authorization</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">auth</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">check_auth</span><span class="p">(</span><span class="n">auth</span><span class="o">.</span><span class="n">username</span><span class="p">,</span> <span class="n">auth</span><span class="o">.</span><span class="n">password</span><span class="p">):</span>
            <span class="n">authenticate</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">decorated</span>
</code></pre></div>

<p><strong>日志(Logging)</strong></p>
<p>日志是装饰器运用的另一个亮点。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>
<span class="k">def</span> <span class="nf">logit</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">with_logging</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;被调用&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">with_logging</span>

<span class="nd">@logit</span>
<span class="k">def</span> <span class="nf">addition_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">x</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">addition_func</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>addition_func被调用
</code></pre></div>

<h4 id="_9">带参数的装饰器</h4>
<p><strong>在函数中嵌入装饰器</strong></p>
<p>在刚才的日志铺子中创建一个包裹函数，可以用来指定一个用于输出的日志文件。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">logit</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="s2">&quot;out.log&quot;</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">logging_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapped_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">lgo_string</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;被调用&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">lgo_string</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">logfile</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">opened_file</span><span class="p">:</span>
                <span class="n">opened_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">lgo_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapped_function</span>
    <span class="k">return</span> <span class="n">logging_decorator</span>
</code></pre></div>

<p>执行1及结果：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">@logit</span><span class="p">()</span><span class="w"></span>
<span class="n">def</span><span class="w"> </span><span class="n">myfunc1</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">    </span><span class="n">pass</span><span class="w"></span>

<span class="n">myfunc1</span><span class="p">()</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">执行结果</span><span class="w"></span>
<span class="n">myfunc1被调用</span><span class="w"></span>
<span class="n">#当前目录下会生成文件out</span><span class="p">.</span><span class="nf">log</span><span class="p">,</span><span class="n">而且</span><span class="err">“</span><span class="n">myfunc1被调用</span><span class="err">”</span><span class="n">被写入</span><span class="err">。</span><span class="w"></span>
</code></pre></div>

<p>执行2及结果：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">@logit</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="ss">&quot;func2.log&quot;</span><span class="p">)</span><span class="w"></span>
<span class="n">def</span><span class="w"> </span><span class="n">myfunc2</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">    </span><span class="n">pass</span><span class="w"></span>

<span class="n">myfunc2</span><span class="p">()</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">执行结果</span><span class="w"></span>
<span class="n">myfunc2被调用</span><span class="w"></span>
<span class="n">#当前目录下会生成文件func2</span><span class="p">.</span><span class="nf">log</span><span class="p">,</span><span class="n">而且</span><span class="err">“</span><span class="n">myfunc2被调用</span><span class="err">”</span><span class="n">被写入</span><span class="err">。</span><span class="w"></span>
</code></pre></div>

<p><strong>装饰器类</strong></p>
<p>类也可以用来构建装饰器。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="k">class</span> <span class="nc">logit</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">logfile</span><span class="o">=</span><span class="s1">&#39;out.log&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">logfile</span> <span class="o">=</span> <span class="n">logfile</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">wrapped_function</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">log_string</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;被调用&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">log_string</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logfile</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">opened_file</span><span class="p">:</span>
                <span class="n">opened_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">log_string</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notify</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">wrapped_function</span>

    <span class="k">def</span> <span class="nf">notify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 只用于日志</span>
        <span class="k">pass</span>
</code></pre></div>

<p>执行及结果：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">@logit</span><span class="p">()</span><span class="w"></span>
<span class="n">def</span><span class="w"> </span><span class="n">myfunc1</span><span class="p">()</span><span class="err">:</span><span class="w"></span>
<span class="w">    </span><span class="n">pass</span><span class="w"></span>

<span class="n">myfunc1</span><span class="p">()</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">执行结果</span><span class="w"></span>
<span class="n">myfunc1被调用</span><span class="w"></span>
<span class="n">#当前目录下会生成文件out</span><span class="p">.</span><span class="nf">log</span><span class="p">,</span><span class="n">而且</span><span class="err">“</span><span class="n">myfunc1被调用</span><span class="err">”</span><span class="n">被写入</span><span class="err">。</span><span class="w"></span>
</code></pre></div>

<p>为了保存日志的同时，给相关人员发送邮件，可以给logit创建一个子类，来添加邮件功能。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="n">email_logit</span><span class="p">(</span><span class="n">logit</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="o">=</span><span class="ss">&quot;test@test.cn&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="n">self</span><span class="p">.</span><span class="n">email</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">email</span><span class="w"></span>
<span class="w">        </span><span class="n">super</span><span class="p">(</span><span class="n">logit</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="n">def</span><span class="w"> </span><span class="n">notify</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="err">:</span><span class="w"></span>
<span class="w">        </span><span class="err">#</span><span class="w"> </span><span class="n">邮件功能实现略</span><span class="w"></span>
<span class="w">        </span><span class="n">pass</span><span class="w"></span>
</code></pre></div>

<p>现在<code>@email_logit</code>在打日志的基础上，还有发邮件的功能。</p>
<h3 id="globalreturn">Global和Return</h3>
<p>return和global的作用，如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">add</span><span class="ss">(</span><span class="nv">value1</span>, <span class="nv">value2</span><span class="ss">)</span>:
    <span class="k">return</span> <span class="nv">value1</span> <span class="o">+</span>  <span class="nv">value2</span>

<span class="nb">result</span> <span class="o">=</span> <span class="nv">add</span><span class="ss">(</span><span class="mi">3</span>, <span class="mi">5</span><span class="ss">)</span>
<span class="nv">print</span><span class="ss">(</span><span class="nb">result</span><span class="ss">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">8</span>
</code></pre></div>

<p>return&lt;函数把值赋给了调用它的变量。</p>
<div class="codehilite"><pre><span></span><code>def add(value1,value2):
    global result
    result = value1 + value2

add(3,5)
print(result)
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">8</span>
</code></pre></div>

<p>global的作用是在函数以外的区域都能访问这个变量。举个例子：</p>
<div class="codehilite"><pre><span></span><code>def add(value1, value2):
    result = value1 + value2

add(2, 4)
print(result)
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>Traceback (most recent call last):
  File &quot;E:\公司文档\分享内容\markdown\python进阶\29.py&quot;, line 7, in &lt;module&gt;
    print(result)
NameError: name &#39;result&#39; is not defined
</code></pre></div>

<p>函数内的result只是局部变量，不要被用于函数外部。申明global后可正常执行，但应尽量避免使用global，它会引入多余的变量到全局作用域。</p>
<h4 id="return">多个return值</h4>
<p>返回多个值，不建议使用global关键字，使用元组(tuple)，列表(list)，字典(dict)是可行的，但并不是最好的，按照惯例如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">profile</span><span class="ss">()</span>:
    <span class="nv">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="s">Tester</span><span class="s2">&quot;</span>
    <span class="nv">age</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="k">return</span> <span class="nv">name</span>, <span class="nv">age</span>

<span class="nv">print</span><span class="ss">(</span><span class="s2">&quot;</span><span class="s">name:</span><span class="s2">&quot;</span>,<span class="nv">profile</span><span class="ss">()</span>[<span class="mi">0</span>]<span class="ss">)</span>
<span class="nv">print</span><span class="ss">(</span><span class="s2">&quot;</span><span class="s">age:</span><span class="s2">&quot;</span>,<span class="nv">profile</span><span class="ss">()</span>[<span class="mi">1</span>]<span class="ss">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="n">name</span><span class="o">:</span> <span class="n">Tester</span>
<span class="n">age</span><span class="o">:</span> <span class="mi">30</span>
</code></pre></div>

<h3 id="mutation">对象变动（Mutation)</h3>
<p>Python中有可变与不可变的数据类型。可变意味着“可以被改动”，而不变的意思就是“常量”。举例如下：</p>
<div class="codehilite"><pre><span></span><code>poo = [&#39;hi&#39;]
print(poo)

bar = poo
bar += [&#39;bye&#39;]
print(poo)
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="k">[&#39;hi&#39;]</span>
<span class="k">[&#39;hi&#39;, &#39;bye&#39;]</span>
</code></pre></div>

<p>这不是一个问题。这个是对象可变性。每当你将一个变量赋值为另一个可变类型的变量时，对这个数据的任意改动会同时反映到这两个变量上去。新变量不过是老变量的一个别名。</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">add_to</span><span class="ss">(</span><span class="nv">num</span>, <span class="nv">target</span><span class="o">=</span>[]<span class="ss">)</span>:
    <span class="nv">target</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">num</span><span class="ss">)</span>
    <span class="k">return</span> <span class="nv">target</span>

<span class="nv">print</span><span class="ss">(</span><span class="nv">add_to</span><span class="ss">(</span><span class="mi">1</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="nv">add_to</span><span class="ss">(</span><span class="mi">2</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="nv">add_to</span><span class="ss">(</span><span class="mi">3</span><span class="ss">))</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="k">[1]</span>
<span class="k">[1, 2]</span>
<span class="k">[1, 2, 3]</span>
</code></pre></div>

<p>在Python中当函数被定义时，默认参数只运算一次，而不是每次用时都会重新运算。所以不要定义可变类型的默认参数，除非这个默认参数是你真的需要的。为了达到效果，你可以这样做：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">def</span> <span class="nv">add_to</span><span class="ss">(</span><span class="nv">element</span>, <span class="nv">target</span><span class="o">=</span><span class="nv">None</span><span class="ss">)</span>:
    <span class="k">if</span> <span class="nv">target</span> <span class="nv">is</span> <span class="nv">None</span>:
        <span class="nv">target</span> <span class="o">=</span> []
    <span class="nv">target</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">element</span><span class="ss">)</span>
    <span class="k">return</span> <span class="nv">target</span>

<span class="nv">print</span><span class="ss">(</span><span class="nv">add_to</span><span class="ss">(</span><span class="mi">1</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="nv">add_to</span><span class="ss">(</span><span class="mi">2</span><span class="ss">))</span>
<span class="nv">print</span><span class="ss">(</span><span class="nv">add_to</span><span class="ss">(</span><span class="mi">3</span><span class="ss">))</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="k">[1]</span>
<span class="k">[2]</span>
<span class="k">[3]</span>
</code></pre></div>

<h3 id="__slots__"><code>__slots__</code>魔法</h3>
<p>在Python中，每个类都有实例属性。默认情况下Python用一个字典来保存一个对象的实例属性。不过，这个字典浪费了很多内存。Python不能在对象创建时直接分配一个固定量的来保存所有属性。因此创建许多象，会消耗很多内存。不过可以用<code>__slots__</code>来告诉Python不要使用字典，而且只给一个固定集合的属性分配空间。举个列子：</p>
<ul>
<li>不使用<code>__slots__</code></li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">MyClass</span>(<span class="n">object</span>):
    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>, <span class="nb">name</span>, <span class="n">age</span>):
        <span class="nb">self</span>.<span class="nb">name</span> = <span class="nb">name</span>
        <span class="nb">self</span>.<span class="n">age</span> = <span class="n">age</span>
        <span class="nb">self</span>.<span class="n">set_up</span>()
    <span class="c1"># ...</span>
</code></pre></div>

<ul>
<li>使用<code>__slots__</code></li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="n">MyClass</span>(<span class="n">object</span>):
    <span class="n">__slots__</span> = [<span class="s">&#39;name&#39;</span>, <span class="s">&#39;age&#39;</span>]
    <span class="n">def</span> <span class="n">__init__</span>(<span class="nb">self</span>, <span class="nb">name</span>, <span class="n">age</span>):
        <span class="nb">self</span>.<span class="nb">name</span> = <span class="nb">name</span>
        <span class="nb">self</span>.<span class="n">age</span> = <span class="n">age</span>
        <span class="nb">self</span>.<span class="n">set_up</span>()
    <span class="c1"># ...</span>
</code></pre></div>

<p>第二段代码会减少40~50%的内存占用，可以通过<a href="https://github.com/ianozsvald/ipython_memory_usage">ipython_memory_usage</a>来查看效果，这里安装失败了，暂不对比。</p>
<h3 id="_10">虚拟环境</h3>
<h4 id="virtualenv">virtualenv</h4>
<p>virtualenv是一个可以创建独立（隔离）的Python环境的工具。它可以为每一个程序创建一个独立的环境，只为自己安装依赖的模块，而不用全局安装所有依赖的模块。</p>
<p>安装virtualenv</p>
<div class="codehilite"><pre><span></span><code>pip install virtualenv
</code></pre></div>

<p>常用的命令：</p>
<div class="codehilite"><pre><span></span><code># 在myproject文件夹下创建一个隔离的virtualenv环境
virtualenv myproject
# 激活这个隔离的环境
source bin/activate
# 退出当前virtualenv
deactivate  # 恢复使用系统全局Python模块
</code></pre></div>

<p>如果你想让你的virtualenv使用全局模块，可以用<code>--system-site-packages</code>参数创建virtualenv，如下：</p>
<div class="codehilite"><pre><span></span><code>virtualenv --system-site-packages myproject
</code></pre></div>

<h3 id="collections">容器Collections</h3>
<p>Python附带一个模块collections，它包含许多容器数据类型，如<code>defaultdict</code>，<code>counter</code>,<code>deque</code>,<code>namedtuple</code>,<code>enum.Enum</code>。</p>
<h4 id="defaultdict">defaultdict</h4>
<p>defaultdict，与dict类型不同，不需要检查key是否存在，举例如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="n">colours</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span> <span class="s1">&#39;黄色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span> <span class="s1">&#39;蓝色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;王五&#39;</span><span class="p">,</span> <span class="s1">&#39;绿色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span> <span class="s1">&#39;黑色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span> <span class="s1">&#39;红色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;赵六&#39;</span><span class="p">,</span> <span class="s1">&#39;紫色&#39;</span><span class="p">),</span>
    <span class="p">)</span>

<span class="n">favourite_colours</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">colour</span> <span class="ow">in</span> <span class="n">colours</span><span class="p">:</span>
    <span class="n">favourite_colours</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colour</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">favourite_colours</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>defaultdict(&lt;class &#39;list&#39;&gt;, {&#39;张三&#39;: [&#39;黄色&#39;, &#39;红色&#39;], &#39;李四&#39;: [&#39;蓝色&#39;, &#39;黑色&#39;], &#39;王五&#39;: [&#39;绿色&#39;], &#39;赵六&#39;: [&#39;紫色&#39;]})
</code></pre></div>

<p>当在一个字典中对一个键进行嵌套赋值时，如果这个键不存在，会触发keyError异常。defaultdict允许绕过这个问题。举例如下：</p>
<div class="codehilite"><pre><span></span><code>some_dict = {}
some_dict[&#39;colours&#39;][&#39;favourite&#39;] = &quot;yellow&quot;
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>Traceback (most recent call last):
  File &quot;E:\公司文档\分享内容\markdown\python进阶\35.py&quot;, line 2, in &lt;module&gt;
    some_dict[&#39;colours&#39;][&#39;favourite&#39;] = &quot;yellow&quot;
KeyError: &#39;colours&#39;
</code></pre></div>

<p>解决方案：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="n">tree</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span><span class="n">collections</span><span class="o">.</span><span class="n">defaultdict</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
<span class="n">some_dict</span> <span class="o">=</span> <span class="n">tree</span><span class="p">()</span>
<span class="n">some_dict</span><span class="p">[</span><span class="s1">&#39;colours&#39;</span><span class="p">][</span><span class="s1">&#39;favourite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;yellow&quot;</span>

<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">some_dict</span><span class="p">))</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>{&quot;colours&quot;: {&quot;favourite&quot;: &quot;yellow&quot;}}
</code></pre></div>

<h4 id="counter">Counter</h4>
<p>Counter是一个计数器，它可以帮助我们针对某项数据进行计数。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">colours</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span> <span class="s1">&#39;黄色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span> <span class="s1">&#39;蓝色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;王五&#39;</span><span class="p">,</span> <span class="s1">&#39;绿色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;李四&#39;</span><span class="p">,</span> <span class="s1">&#39;黑色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;张三&#39;</span><span class="p">,</span> <span class="s1">&#39;红色&#39;</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;赵六&#39;</span><span class="p">,</span> <span class="s1">&#39;紫色&#39;</span><span class="p">),</span>
    <span class="p">)</span>

<span class="n">favs</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">colour</span> <span class="ow">in</span> <span class="n">colours</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">favs</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>Counter({&#39;张三&#39;: 2, &#39;李四&#39;: 2, &#39;王五&#39;: 1, &#39;赵六&#39;: 1})
</code></pre></div>

<h4 id="deque">deque</h4>
<p>deque提供了一个双端队列，你可以从头/尾两端添加或删除元素。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
<span class="c1"># 用法和list差不多</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">3</span>
<span class="mf">1</span>
<span class="mf">3</span>
</code></pre></div>

<p>从两端删除数据：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">popleft</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">5</span>
<span class="mf">0</span>
<span class="mf">4</span>
<span class="n">deque</span><span class="p">(</span><span class="err">[</span><span class="mf">1</span><span class="p">,</span> <span class="mf">2</span><span class="p">,</span> <span class="mf">3</span><span class="err">]</span><span class="p">)</span>
</code></pre></div>

<p>可以限制deque的大小，当超过这个限制时，会把左边的数据挤出去。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
<span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>deque([&#39;2&#39;, &#39;3&#39;], maxlen=2)
</code></pre></div>

<p>从两端扩展数据：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">extendleft</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="n">d</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>deque([0, 1, 2, 3, 4, 5, 6, 7, 8])
</code></pre></div>

<h4 id="namedtuple">namedtuple</h4>
<p>namedtuple把元组变成一个简单任务的容器，不用像元组那样使用整数索引来访问一个namedtuple数据，而是像字典一样访问namedtuple，namedtuple也是不可娈的。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">Animal</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Animal&#39;</span><span class="p">,</span> <span class="s1">&#39;name age type&#39;</span><span class="p">)</span>
<span class="n">perry</span> <span class="o">=</span> <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;perry&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;cat&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">perry</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perry</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>Animal(name=&#39;perry&#39;, age=31, type=&#39;cat&#39;)
perry
</code></pre></div>

<p>命名元组是不可娈的。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">Animal</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Animal&#39;</span><span class="p">,</span> <span class="s1">&#39;name age type&#39;</span><span class="p">)</span>
<span class="n">perry</span> <span class="o">=</span> <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;perry&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;cat&quot;</span><span class="p">)</span>
<span class="n">perry</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="mi">42</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>Traceback (most recent call last):
  File &quot;E:\公司文档\分享内容\markdown\python进阶\44.py&quot;, line 7, in &lt;module&gt;
    perry.age = 42
AttributeError: can&#39;t set attribute
</code></pre></div>

<p>命名元组可以兼容普通元组，就是说你也可以用整数索引来访问namedtuple。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">Animal</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Animal&#39;</span><span class="p">,</span> <span class="s1">&#39;name age type&#39;</span><span class="p">)</span>
<span class="n">perry</span> <span class="o">=</span> <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;perry&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;cat&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perry</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>perry
</code></pre></div>

<p>命名元组可以转换为字典。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">Animal</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Animal&#39;</span><span class="p">,</span> <span class="s1">&#39;name age type&#39;</span><span class="p">)</span>
<span class="n">perry</span> <span class="o">=</span> <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;perry&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;cat&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">perry</span><span class="o">.</span><span class="n">_asdict</span><span class="p">())</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>{&#39;name&#39;: &#39;perry&#39;, &#39;age&#39;: 31, &#39;type&#39;: &#39;cat&#39;}
</code></pre></div>

<h4 id="enumenum">enum.Enum</h4>
<p>让我们回顾⼀下上⼀个'Animal'命名元组的例⼦。它有⼀个type字段，问题是，type是⼀个字符串。那么问题来了，万⼀程序员输⼊了Cat，因为他按到了Shift键，或者输⼊了'CAT'，甚⾄'kitten'？枚举可以帮助我们避免这个问题，通过不使⽤字符串。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>

<span class="k">class</span> <span class="nc">Species</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">cat</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">dog</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">horse</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">aardvark</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="n">butterfly</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">owl</span> <span class="o">=</span> <span class="mi">6</span>
    <span class="n">platypus</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">dragon</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">unicorn</span> <span class="o">=</span> <span class="mi">9</span>
    <span class="c1"># ……</span>

    <span class="n">kitten</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">puppy</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">Animal</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">&#39;Animal&#39;</span><span class="p">,</span> <span class="s1">&#39;name age type&#39;</span><span class="p">)</span>
<span class="n">perry</span> <span class="o">=</span> <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Perry&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Species</span><span class="o">.</span><span class="n">cat</span><span class="p">)</span>
<span class="n">drogon</span> <span class="o">=</span> <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Drogon&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Species</span><span class="o">.</span><span class="n">dragon</span><span class="p">)</span>
<span class="n">tom</span> <span class="o">=</span> <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Species</span><span class="o">.</span><span class="n">cat</span><span class="p">)</span>
<span class="n">charlie</span> <span class="o">=</span> <span class="n">Animal</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">Species</span><span class="o">.</span><span class="n">kitten</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">charlie</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">tom</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">charlie</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>True
Species.cat
</code></pre></div>

<p>这样就没有那么容易错误了，但应该只使用定义了的枚举类型。有三种方法访问枚举类型，如以下方法都可以获取<code>cat</code>的值：</p>
<div class="codehilite"><pre><span></span><code>Species(1)
Species[&#39;cat&#39;]
Species.cat
</code></pre></div>

<h3 id="enumerate">枚举Enumerate</h3>
<p>枚举是python的内置函数。它的作用举例来说明，如下：</p>
<p><strong>枚举允许遍历数据并自动计数。</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">some_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;苹果&#39;</span><span class="p">,</span> <span class="s1">&#39;香蕉&#39;</span><span class="p">,</span> <span class="s1">&#39;葡萄&#39;</span><span class="p">,</span> <span class="s1">&#39;梨子&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">counter</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">some_list</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">0</span> <span class="n">苹果</span>
<span class="mf">1</span> <span class="n">香蕉</span>
<span class="mf">2</span> <span class="n">葡萄</span>
<span class="mf">3</span> <span class="n">梨子</span>
</code></pre></div>

<p><strong>枚举还可以接受一些可选参数。</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">some_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;苹果&#39;</span><span class="p">,</span> <span class="s1">&#39;香蕉&#39;</span><span class="p">,</span> <span class="s1">&#39;葡萄&#39;</span><span class="p">,</span> <span class="s1">&#39;梨子&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">counter</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">some_list</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>   <span class="c1"># 计数从2开始</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">2</span> <span class="n">苹果</span>
<span class="mf">3</span> <span class="n">香蕉</span>
<span class="mf">4</span> <span class="n">葡萄</span>
<span class="mf">5</span> <span class="n">梨子</span>
</code></pre></div>

<p><strong>枚举可以用来创建包含索引的元组列表。</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">some_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;苹果&#39;</span><span class="p">,</span> <span class="s1">&#39;香蕉&#39;</span><span class="p">,</span> <span class="s1">&#39;葡萄&#39;</span><span class="p">,</span> <span class="s1">&#39;梨子&#39;</span><span class="p">]</span>
<span class="n">counter_list</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">enumerate</span><span class="p">(</span><span class="n">some_list</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counter_list</span><span class="p">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>[(0, &#39;苹果&#39;), (1, &#39;香蕉&#39;), (2, &#39;葡萄&#39;), (3, &#39;梨子&#39;)]
</code></pre></div>

<h3 id="_11">对象自省</h3>
<p>自省，上指在运行时来判断一个对象的类型的能力。</p>
<h4 id="dir">dir</h4>
<p>dir是用于自省的最重要的函数之一。它返回一个列表，列出一个对象所拥有的属性和方法。如下：</p>
<div class="codehilite"><pre><span></span><code>my_list = [1, 2, 3]
print(dir(my_list))
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>[&#39;__add__&#39;, &#39;__class__&#39;, &#39;__class_getitem__&#39;, &#39;__contains__&#39;, &#39;__delattr__&#39;, &#39;__delitem__&#39;, &#39;__dir__&#39;, &#39;__doc__&#39;, &#39;__eq__&#39;, &#39;__format__&#39;, &#39;__ge__&#39;, &#39;__getattribute__&#39;, &#39;__getitem__&#39;, &#39;__gt__&#39;, &#39;__hash__&#39;, &#39;__iadd__&#39;, &#39;__imul__&#39;, &#39;__init__&#39;, &#39;__init_subclass__&#39;, &#39;__iter__&#39;, &#39;__le__&#39;, &#39;__len__&#39;, &#39;__lt__&#39;, &#39;__mul__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;, &#39;__reduce__&#39;, &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__reversed__&#39;, &#39;__rmul__&#39;, &#39;__setattr__&#39;, &#39;__setitem__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;, &#39;__subclasshook__&#39;, &#39;append&#39;, &#39;clear&#39;, &#39;copy&#39;, &#39;count&#39;, &#39;extend&#39;, &#39;index&#39;, &#39;insert&#39;, &#39;pop&#39;, &#39;remove&#39;, &#39;reverse&#39;, &#39;sort&#39;]
</code></pre></div>

<p>上面的自省给了这个列表对象所有的方法的名字，如果你不清楚其所具有的方法，可以使用dir()来查询。</p>
<h4 id="typeid">type和id</h4>
<p><strong>type函数返回一个对象的类型。如下：</strong></p>
<div class="codehilite"><pre><span></span><code>print(type(&#39;&#39;))
print(type([]))
print(type({}))
print(type(dict))
print(type(3))
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>&lt;class &#39;str&#39;&gt;
&lt;class &#39;list&#39;&gt;
&lt;class &#39;dict&#39;&gt;
&lt;class &#39;type&#39;&gt;
&lt;class &#39;int&#39;&gt;
</code></pre></div>

<p><strong>id()函数返回任意不同各类对象的唯一id。如下：</strong></p>
<div class="codehilite"><pre><span></span><code>name = &quot;tester&quot;
print(id(name))
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">1546700355120</span>
</code></pre></div>

<h4 id="inspect">inspect模块</h4>
<p>inspect模块也提供了许多有用的函数，来获取活跃对象的信息。比如，你可以查看一个对象的成员，只需运行：</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">inspect</span>
<span class="nb">print</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="nb">str</span><span class="p">))</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="p">[(</span><span class="s">&#39;__add__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__add__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__class__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">class</span> <span class="s">&#39;type&#39;</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__contains__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__contains__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__delattr__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__delattr__&#39;</span> <span class="kr">of</span> <span class="s">&#39;object&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__dir__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;__dir__&#39;</span> <span class="kr">of</span> <span class="s">&#39;object&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__doc__&#39;</span><span class="p">,</span> <span class="s">&quot;str(object=&#39;&#39;) -&gt; str\nstr(bytes_or_buffer[, encoding[, errors]]) -&gt; str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer\nthat will be decoded using the given encoding and error handler.\nOtherwise, returns the result of object.__str__() (if defined)\nor repr(object).\nencoding defaults to sys.getdefaultencoding().\nerrors defaults to &#39;</span><span class="n">strict</span><span class="s">&#39;.&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__eq__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__eq__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__format__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;__format__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__ge__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__ge__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__getattribute__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__getattribute__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__getitem__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__getitem__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__getnewargs__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;__getnewargs__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__gt__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__gt__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__hash__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__hash__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__init__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__init__&#39;</span> <span class="kr">of</span> <span class="s">&#39;object&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__init_subclass__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="kr">in</span> <span class="n">method</span> <span class="n">__init_subclass__</span> <span class="kr">of</span> <span class="kr">type</span> <span class="n">object</span> <span class="n">at</span> <span class="mh">0x00007FF9D967AC60</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__iter__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__iter__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__le__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__le__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__len__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__len__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__lt__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__lt__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__mod__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__mod__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__mul__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__mul__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__ne__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__ne__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__new__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="kr">in</span> <span class="n">method</span> <span class="n">__new__</span> <span class="kr">of</span> <span class="kr">type</span> <span class="n">object</span> <span class="n">at</span> <span class="mh">0x00007FF9D967AC60</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__reduce__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;__reduce__&#39;</span> <span class="kr">of</span> <span class="s">&#39;object&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__reduce_ex__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;__reduce_ex__&#39;</span> <span class="kr">of</span> <span class="s">&#39;object&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__repr__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__repr__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__rmod__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__rmod__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__rmul__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__rmul__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__setattr__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__setattr__&#39;</span> <span class="kr">of</span> <span class="s">&#39;object&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__sizeof__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;__sizeof__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__str__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">slot</span> <span class="n">wrapper</span> <span class="s">&#39;__str__&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;__subclasshook__&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="kr">in</span> <span class="n">method</span> <span class="n">__subclasshook__</span> <span class="kr">of</span> <span class="kr">type</span> <span class="n">object</span> <span class="n">at</span> <span class="mh">0x00007FF9D967AC60</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;capitalize&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;capitalize&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;casefold&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;casefold&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;center&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;center&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;count&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;count&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;encode&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;encode&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;endswith&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;endswith&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;expandtabs&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;expandtabs&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;find&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;find&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;format&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;format&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;format_map&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;format_map&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;index&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;index&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isalnum&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isalnum&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isalpha&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isalpha&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isascii&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isascii&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isdecimal&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isdecimal&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isdigit&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isdigit&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isidentifier&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isidentifier&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;islower&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;islower&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isnumeric&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isnumeric&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isprintable&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isprintable&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isspace&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isspace&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;istitle&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;istitle&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;isupper&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;isupper&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;join&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;join&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;ljust&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;ljust&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;lower&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;lower&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;lstrip&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;lstrip&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;maketrans&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="kr">in</span> <span class="n">method</span> <span class="n">maketrans</span> <span class="kr">of</span> <span class="kr">type</span> <span class="n">object</span> <span class="n">at</span> <span class="mh">0x00007FF9D967AC60</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;partition&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;partition&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;removeprefix&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;removeprefix&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;removesuffix&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;removesuffix&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;replace&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;replace&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;rfind&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;rfind&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;rindex&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;rindex&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;rjust&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;rjust&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;rpartition&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;rpartition&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;rsplit&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;rsplit&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;rstrip&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;rstrip&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;split&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;split&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;splitlines&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;splitlines&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;startswith&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;startswith&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;strip&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;strip&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;swapcase&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;swapcase&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;title&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;title&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;translate&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;translate&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;upper&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;upper&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;zfill&#39;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">method</span> <span class="s">&#39;zfill&#39;</span> <span class="kr">of</span> <span class="s">&#39;str&#39;</span> <span class="n">objects</span><span class="o">&gt;</span><span class="p">)]</span>
</code></pre></div>

<h3 id="comprehension">推导式Comprehension</h3>
<p>推导式是可以从一个数据序列构建另一个新的数据序列的结构体。共有三种推导：</p>
<ul>
<li>列表（list）推导式</li>
<li>字典（dict）推导式</li>
<li>集合（set）推导式</li>
</ul>
<h4 id="_12">列表推导式</h4>
<p>列表推导式是在一个中括号里包含一个表达式，然后是一个for语句，然后是0个或多个for或者if语句。</p>
<p><strong>规范</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">variable</span> <span class="o">=</span> <span class="p">[</span><span class="n">out_exp</span> <span class="k">for</span> <span class="n">out_exp</span> <span class="ow">in</span> <span class="n">input_list</span> <span class="k">if</span> <span class="n">out_exp</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span>
</code></pre></div>

<p>举例如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">multiples</span> <span class="o">=</span> [<span class="nv">i</span> <span class="k">for</span> <span class="nv">i</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="mi">30</span><span class="ss">)</span> <span class="k">if</span> <span class="nv">i</span><span class="o">%</span><span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span>]
<span class="nv">print</span><span class="ss">(</span><span class="nv">multiples</span><span class="ss">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>[0, 3, 6, 9, 12, 15, 18, 21, 24, 27]
</code></pre></div>

<p>这个对快速生成列表很有用。列表推导式在使用for循环生成一个新列表时，非常好用，如下：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">squared</span> <span class="o">=</span> []
<span class="k">for</span> <span class="nv">x</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="mi">10</span><span class="ss">)</span>:
    <span class="nv">squared</span>.<span class="nv">append</span><span class="ss">(</span><span class="nv">x</span><span class="o">**</span><span class="mi">2</span><span class="ss">)</span>
</code></pre></div>

<p>这个用推导式就可以简化为：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">squared</span> <span class="o">=</span> [<span class="nv">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="nv">x</span> <span class="nv">in</span> <span class="nv">range</span><span class="ss">(</span><span class="mi">10</span><span class="ss">)</span>]
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>[0, 1, 4, 9, 16, 25, 36, 49, 64, 81]
</code></pre></div>

<h4 id="_13">字典推导式</h4>
<p>字典推导式和列表推导式用法是类似的。如下：</p>
<p>将字典中一个字母但不同大小写的值合并起来：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">mcase</span> <span class="o">=</span> {<span class="s1">&#39;</span><span class="s">a</span><span class="s1">&#39;</span>: <span class="mi">10</span>, <span class="s1">&#39;</span><span class="s">b</span><span class="s1">&#39;</span>: <span class="mi">34</span>, <span class="s1">&#39;</span><span class="s">A</span><span class="s1">&#39;</span>: <span class="mi">7</span>, <span class="s1">&#39;</span><span class="s">Z</span><span class="s1">&#39;</span>: <span class="mi">3</span>}

<span class="nv">mcase_frequency</span> <span class="o">=</span> {
    <span class="nv">k</span>.<span class="nv">lower</span><span class="ss">()</span>:<span class="nv">mcase</span>.<span class="nv">get</span><span class="ss">(</span><span class="nv">k</span>.<span class="nv">lower</span><span class="ss">()</span>, <span class="mi">0</span><span class="ss">)</span> <span class="o">+</span> <span class="nv">mcase</span>.<span class="nv">get</span><span class="ss">(</span><span class="nv">k</span>.<span class="nv">upper</span><span class="ss">()</span>, <span class="mi">0</span><span class="ss">)</span>
    <span class="k">for</span> <span class="nv">k</span> <span class="nv">in</span> <span class="nv">mcase</span>.<span class="nv">keys</span><span class="ss">()</span>
}

<span class="nv">print</span><span class="ss">(</span><span class="nv">mcase_frequency</span><span class="ss">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>{&#39;a&#39;: 17, &#39;b&#39;: 34, &#39;z&#39;: 3}
</code></pre></div>

<h4 id="_14">集合推导式</h4>
<p>它和列表推导式也是类似的。唯一区别在于它作用大括号{}。举个例子：</p>
<div class="codehilite"><pre><span></span><code><span class="nv">squared</span> <span class="o">=</span> {<span class="nv">x</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="nv">x</span> <span class="nv">in</span> [<span class="mi">1</span>, <span class="mi">1</span>, <span class="mi">2</span>]}
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>{1, 4}
</code></pre></div>

<h3 id="_15">异常</h3>
<p>最基本的就是<code>try/except</code>从句。可能触发异常的代码会放到try语句块里，而处理异常的代码会在except语句块中。举个例子：</p>
<div class="codehilite"><pre><span></span><code><span class="k">try</span><span class="o">:</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">open</span><span class="o">(</span><span class="s1">&#39;test.txe&#39;</span><span class="o">,</span> <span class="s1">&#39;rb&#39;</span><span class="o">)</span>
<span class="n">except</span> <span class="n">IOError</span> <span class="k">as</span> <span class="n">e</span><span class="o">:</span>
    <span class="n">print</span><span class="o">(</span><span class="s2">&quot;一个读写错误发生:{}&quot;</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">args</span><span class="o">[-</span><span class="mi">1</span><span class="o">]))</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="err">一个读写错误发生</span><span class="o">:</span><span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="n">or</span> <span class="n">directory</span>
</code></pre></div>

<h4 id="_16">处理多个异常</h4>
<p>有三种方法可以用来处理多个异常。</p>
<ol>
<li>需要把所有可能发生的异常放到一个元组里面。如下：</li>
</ol>
<p><code>try:
       file = open('test.txe', 'rb')
   except (IOError, EOFError) as e:
       print("一个读写错误发生:{}".format(e.args[-1]))</code></p>
<ol>
<li>对每个单独的异常在单独的except语句块中处理。如下：</li>
</ol>
<p><code>try:
       file = open('test.txe', 'rb')
   except EOFError as e:
       print("一个EOF错误发生。")
       raise e
   except IOError as e:
       print("一个读写错误发生。")
       raise e</code></p>
<ol>
<li>直接捕获所有异常</li>
</ol>
<p><code>try:
       file = open('test.txe', 'rb')
   except Exception:
       # 打印一些想要的异常日志
       raise</code></p>
<p>当你不知道程序会抛什么异常的时候，第三种方法比较好用。</p>
<h4 id="finally">finally从句</h4>
<p>除了try和eccept从句，还有第三个从句，就是finally从句。finally从句中的代码不管异常是否触发都会执行。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="k">try</span><span class="o">:</span>
    <span class="n">file</span> <span class="o">=</span> <span class="n">open</span><span class="o">(</span><span class="s1">&#39;test.txe&#39;</span><span class="o">,</span> <span class="s1">&#39;rb&#39;</span><span class="o">)</span>
<span class="n">except</span> <span class="o">(</span><span class="n">IOError</span><span class="o">,</span> <span class="n">EOFError</span><span class="o">)</span> <span class="k">as</span> <span class="n">e</span><span class="o">:</span>
    <span class="n">print</span><span class="o">(</span><span class="s2">&quot;一个读写错误发生:{}&quot;</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">args</span><span class="o">[-</span><span class="mi">1</span><span class="o">]))</span>
<span class="n">finally</span><span class="o">:</span>
    <span class="n">print</span><span class="o">(</span><span class="s2">&quot;不管是否触发异常都会执行。&quot;</span><span class="o">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="err">一个读写错误发生</span><span class="o">:</span><span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="n">or</span> <span class="n">directory</span>
<span class="err">不管是否触发异常都会执行。</span>
</code></pre></div>

<h4 id="tryelse">try/else从句</h4>
<p>如果想在没有触发异常的时候执行一些代码，可以用else从句来达到目的。如下：</p>
<div class="codehilite"><pre><span></span><code><span class="k">try</span><span class="o">:</span>
    <span class="n">print</span><span class="o">(</span><span class="s2">&quot;我确信没有异常发生。&quot;</span><span class="o">)</span>
<span class="n">except</span> <span class="n">Exception</span><span class="o">:</span>
    <span class="n">print</span><span class="o">(</span><span class="s2">&quot;exception.&quot;</span><span class="o">)</span>
<span class="k">else</span><span class="o">:</span>
    <span class="err">#</span> <span class="err">这里的代码只会在</span><span class="n">try语句没有触发异常时运行</span>
    <span class="err">#</span> <span class="err">但这里的异常将不会被捕获</span>
    <span class="n">print</span><span class="o">(</span><span class="s2">&quot;这里的代码只会在try语句没有触发异常时运行,异常将不会被捕获。&quot;</span><span class="o">)</span>
<span class="n">finally</span><span class="o">:</span>
    <span class="n">print</span><span class="o">(</span><span class="s2">&quot;这里将一直被执行。&quot;</span><span class="o">)</span>
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code>我确信没有异常发生。
这里的代码只会在try语句没有触发异常时运行,异常将不会被捕获。
这里将一直被执行。
</code></pre></div>

<p>else从句只会在没有异常的情况下执行，而且它会在finally语句之前执行。</p>
<h3 id="lambda">lambda表达式</h3>
<p>lambada表达式是一行函数，也被称为匿名表达式。</p>
<p><strong>原型</strong></p>
<div class="codehilite"><pre><span></span><code>lambda 参数:操作(参数)
</code></pre></div>

<p>如下：</p>
<div class="codehilite"><pre><span></span><code>add = lambda x, y:x + y
print(add(3, 5))
</code></pre></div>

<p>执行结果：</p>
<div class="codehilite"><pre><span></span><code><span class="mf">8</span>
</code></pre></div>

<p>lambda表达式，可以在一些特殊的情况下使用：</p>
<ul>
<li>列表排序</li>
</ul>
<p><code>a = [(1, 2), (4, 1), (9, 10), (13, -3)]
  a.sort(key=lambda x:x[1])</code></p>
<p>执行结果：</p>
<p><code>[(13, -3), (4, 1), (1, 2), (9, 10)]</code></p>
<ul>
<li>列表并行排序</li>
</ul>
<p>```
  list1 = [1,2,3]
  list2 = [4,5,6]
  data = list(zip(list1, list2))
  data.sort()
  list1, list2 = map(lambda t:list(t), zip(*data))</p>
<p>print(list1)
  print(list2)
  ```</p>
<p>执行结果：</p>
<p><code>[1, 2, 3]
  [4, 5, 6]</code></p></div>
    </div>
    <input class="xswitch xonoff" type="checkbox" id="nvacatalog">
    <div class="nav">
      <ul>
        
        <li><a href="https://testpoo.github.io/debian+openbox+tint2安装过程.html"><span><label style="color: #38b6fd"></label>&nbsp;debian+openbox+tint2安装过程</span></a></li>
        
        <li><a href="https://testpoo.github.io/面试问答.html"><span><label style="color: #38b6fd"></label>&nbsp;面试问答</span></a></li>
        
        <li><a href="https://testpoo.github.io/UI自动化测试神器-Cypress.html"><span><label style="color: #38b6fd"></label>&nbsp;UI自动化测试神器-Cypress</span></a></li>
        
        <li><a href="https://testpoo.github.io/如何用自动化测试搞垮团队.html"><span><label style="color: #38b6fd"></label>&nbsp;如何用自动化测试搞垮团队</span></a></li>
        
        <li><a href="https://testpoo.github.io/常用链接.html"><span><label style="color: #38b6fd"></label>&nbsp;常用链接</span></a></li>
        
        <li><a href="https://testpoo.github.io/mysql函数汇总.html"><span><label style="color: #38b6fd"></label>&nbsp;mysql函数汇总</span></a></li>
        
        <li><a href="https://testpoo.github.io/shell简介.html"><span><label style="color: #38b6fd"></label>&nbsp;shell简介</span></a></li>
        
        <li><a href="https://testpoo.github.io/Docker入门教程.html"><span><label style="color: #38b6fd"></label>&nbsp;Docker入门教程</span></a></li>
        
        <li><a href="https://testpoo.github.io/性能监控各指令详解.html"><span><label style="color: #38b6fd"></label>&nbsp;性能监控各指令详解</span></a></li>
        
        <li><a href="https://testpoo.github.io/Python进阶.html"><span><label style="color: #38b6fd"></label>&nbsp;Python进阶</span></a></li>
        
        <li><a href="https://testpoo.github.io/Git简介.html"><span><label style="color: #38b6fd"></label>&nbsp;Git简介</span></a></li>
        
        <li><a href="https://testpoo.github.io/Python正则表达式.html"><span><label style="color: #38b6fd"></label>&nbsp;Python正则表达式</span></a></li>
        
        <li><a href="https://testpoo.github.io/nose简介.html"><span><label style="color: #38b6fd"></label>&nbsp;nose简介</span></a></li>
        
        <li><a href="https://testpoo.github.io/debian+kde安装过程.html"><span><label style="color: #38b6fd"></label>&nbsp;debian+kde安装过程</span></a></li>
        
        <li><a href="https://testpoo.github.io/debian+xfce安装过程.html"><span><label style="color: #38b6fd"></label>&nbsp;debian+xfce安装过程</span></a></li>
        
        <li><a href="https://testpoo.github.io/Python自动化之unittest.html"><span><label style="color: #38b6fd"></label>&nbsp;Python自动化之unittest</span></a></li>
        
        <li><a href="https://testpoo.github.io/debian+gnome安装过程.html"><span><label style="color: #38b6fd"></label>&nbsp;debian+gnome安装过程</span></a></li>
        
        <li><a href="https://testpoo.github.io/debian+i3安装过程.html"><span><label style="color: #38b6fd"></label>&nbsp;debian+i3安装过程</span></a></li>
        
        <li><a href="https://testpoo.github.io/mysql的安装.html"><span><label style="color: #38b6fd"></label>&nbsp;mysql的安装</span></a></li>
        
        <li><a href="https://testpoo.github.io/问题解决.html"><span><label style="color: #38b6fd"></label>&nbsp;问题解决</span></a></li>
        
        <li><a href="https://testpoo.github.io/分分种学会python3.html"><span><label style="color: #38b6fd"></label>&nbsp;分分种学会python3</span></a></li>
        
        <li><a href="https://testpoo.github.io/Markdown笔记.html"><span><label style="color: #38b6fd"></label>&nbsp;Markdown笔记</span></a></li>
        
        <li><a href="https://testpoo.github.io/Linux下SVN服务器的搭建.html"><span><label style="color: #38b6fd"></label>&nbsp;Linux下SVN服务器的搭建</span></a></li>
        
        <li><a href="https://testpoo.github.io/Debain必备软件.html"><span><label style="color: #38b6fd"></label>&nbsp;Debain必备软件</span></a></li>
        
        <li><a href="https://testpoo.github.io/mysql笔记.html"><span><label style="color: #38b6fd"></label>&nbsp;mysql笔记</span></a></li>
        
        <li><a href="https://testpoo.github.io/python标准异常.html"><span><label style="color: #38b6fd"></label>&nbsp;python标准异常</span></a></li>
        
        <li><a href="https://testpoo.github.io/svn命令全解.html"><span><label style="color: #38b6fd"></label>&nbsp;svn命令全解</span></a></li>
        
        <li><a href="https://testpoo.github.io/debian命令apt和dpkg用法.html"><span><label style="color: #38b6fd"></label>&nbsp;debian命令apt和dpkg用法</span></a></li>
        
        <li><a href="https://testpoo.github.io/关于我.html"><span><label style="color: #38b6fd"></label>&nbsp;关于我</span></a></li>
        
      </ul>
    </div>
  </body>

  </html>